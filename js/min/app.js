var osmUrl="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",osmAttrib='&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',osm=L.tileLayer(osmUrl,{maxZoom:18,attribution:osmAttrib});map=new L.Map("map",{layers:[osm],center:new L.LatLng(51.505,-.04),zoom:13}),drawnItems=L.featureGroup().addTo(map),Feature=Backbone.Model.extend({urlRoot:"./api.php"}),Features=Backbone.Collection.extend({url:"./api.php",model:Feature}),map.addControl(new L.Control.Draw({edit:{featureGroup:drawnItems}})),map.on("draw:created",function(e){var a=e.layer,r=e.layerType;switch(a=e.layer,console.log("created:",r,a),r){case"marker":var t=new Feature({type:r,layer:a});t.save();break;case"polyline":case"polygon":case"circle":case"rectangle":var o=a.encodePath();console.log(o);var n=new Feature({type:r,geometry:o});n.save()}drawnItems.addLayer(a)});